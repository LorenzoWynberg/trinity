# Ralph Activity Log - 2026-01-28

## Fix: Dashboard Refine Endpoint Timeout

**Time:** 2026-01-28 ~05:30 SAST

### Problem

The `/api/prd/refine` endpoint was failing with:
```
Signal: SIGTERM
Killed: true
POST /api/prd/refine 500 in 2.0min
```

The endpoint was timing out after the default 2-minute timeout when trying to analyze 91 stories. The `/api/prd/story` endpoint worked fine because it only handles one story at a time.

### Root Cause

The `runClaude()` helper has a default timeout of 120000ms (2 minutes). Analyzing all pending stories takes longer than this, causing Node.js to kill the Claude process with SIGTERM.

### Solution

1. Increased refine endpoint timeout to 10 minutes (600000ms)
2. Added debug logging to `runClaude()` and refine route for future diagnosis:
   - Request ID, file paths, CWD, prompt length
   - On error: exit code, signal, killed status, stdout/stderr

### Files modified

- `tools/ralph/dashboard/src/app/api/prd/refine/route.ts` - Added timeout option and debug logging
- `tools/ralph/dashboard/src/lib/claude.ts` - Added debug logging for Claude execution
- `docs/knowledge/ralph-dashboard/prd-tools.md` - Added Timeouts section documenting limits

### Commit

`8b3557f` - fix(dashboard): increase refine timeout to 10 minutes and add debug logging

---
